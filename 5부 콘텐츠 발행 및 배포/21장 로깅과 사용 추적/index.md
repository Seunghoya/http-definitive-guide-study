## 21장 로깅과 사용 추적

### 21.1 로그란 무엇인가?

- 서버나 프락시의 문제를 찾거나, 웹 사이트 접근 통계(마케팅, 청구, 장비 조달 계획을 세우기 위한)를 내려고 로깅을 한다.
- 기본적인 로깅 항목들
  - HTTP 메서드
  - 클라이언트와 서버의 HTTP 버전
  - 요청받은 리소스의 URL
  - 응답의 HTTP 상태 코드
  - 요청과 응답 메시지의 크기 (모든 엔터티 본문을 포함)
  - 트랜잭션이 일어난 시간
  - Referer와 User-Agent 헤더 값

### 21.2 로그 포맷

- 사용 혹은 오픈 소스 HTTP 애플리케이션은 대부분, 표준 로그 포맷 한 개 이상 지원한다.
- 애플리케이션이 더 많은 표준 포맷을 지원하고 관리자가 사용할 수록 얻는 이점들이 있다.
  - ex) 관리자가 지정한 필드를 포함한 로그 포맷을 통해 필요한 통계 추출 가능

#### 21.2.1 일반 로그 포맷(Common Log Format)

- 많은 서버가 기본으로 사용한다.
  ![일반 로그 포맷 필드](https://user-images.githubusercontent.com/74203440/212672641-e4a79dd9-8874-4ac2-96aa-6221e10b05e2.jpeg)

#### 21.2.2 혼합 로그 포맷(Combined Log Format)

- 많이 사용하는 로그 포맷이며, 아파치 같은 서퍼들이 지원한다.
- 추가된 2개의 필드를 제외하면 똑같다.
  ![혼합 로그 포맷에 추가된 필드](https://user-images.githubusercontent.com/74203440/212672656-53a35721-1294-4cdd-ab4e-db8e02070996.jpeg)

#### 21.2.3 넷스케이프 확장 로그 포맷

- 프락시나 웹 캐시 같은 HTTP 애플리케이션과 연관이 있는 여러 환경을 지원하려고 포맷을 확장했다.
  ![넷스케이프 확장 로그 포맷 필드](https://user-images.githubusercontent.com/74203440/212672691-ae264c1a-0c75-479e-b33d-09320b05a246.jpeg)

#### 21.2.4 넷스케이프 확장 2 로그 포맷

- 확장 로그 포맷에 추가된 필드가 있고 HTTP 클라이언트와 HTTP 프락시 애플리케이션 간의 통신을 설계하는데 도움이 된다.
  ![추가된 넷스케이프 확장 2 로그 포맷](https://user-images.githubusercontent.com/74203440/212672713-cd98eb3b-7a44-47a3-a7a5-a12655bfd2b0.jpeg)

#### 21.2.5 스퀴드 (Squid) 프락시 로그 포맷

- 스퀴드는 수년간 오픈 소스 커뮤니티를 통해 확장 및 개선되어 온 프로젝트이며, 스퀴드 애플리케이션을 관리하는데 도움이 되는 도구(처리, 추적, 로그 분석)를 활용하기 위해 스퀴드 포맷을 적용한다.
- 스퀴드는 기본적으로 HTTP와 FTP에 사용되지만 TLS, SSL, HTTPS 등과 같이 많은 프로토콜을 지원한다.
  ![스퀴드 로그 포맷 필드](https://user-images.githubusercontent.com/74203440/212672973-4afe94f5-849b-4e51-96a9-e65f4e0da50e.jpeg)

