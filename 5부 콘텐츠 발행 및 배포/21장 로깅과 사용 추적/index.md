## 3. 적중 계량하기

- 클라이언트와 서버 사이에 캐시가 있기 때문에, 원 서버는 언제나 직접 로그 데이터를 작성할 수 없음
- 프록시 캐시에서 자체 로그를 유지하면 이 문제를 해결할 수 있을 것
- **Hit Metering** 규약은 HTTP의 확장으로, 캐시가 정기적으로 캐시 접근 통계를 원 서버에 보고하도록 함

### 3.1 개요

- 캐시와 서버가 접근 정보를 공유하고, 캐시 리소스의 양을 제어하는 몇 가지 기초적인 HTTP 확장 기능 정의
- 완벽한 해결책이 아니며, 널리 사용되고 있지는 않음
- 그럼에도 불구하고 접근 통계 정보를 취합할 수 있고, 캐시의 이점을 유지할 수 있음

### 3.2 Meter 헤더

- 캐시 및 서버는 Meter 헤더에 사용량이나 보고에 관한 지시자들을 기술할 수 있음

|        지시자         | 약어 | 주체 | 설명                                                  |
| :-------------------: | :--: | :--: | :---------------------------------------------------- |
| will-report-and-limit |  w   | 캐시 | 캐시는 사용량을 보고하고 모든 사용 제한에 복종        |
|      wont-report      |  x   | 캐시 | 캐시는 사용 제한에 복종하지만 사용량 보고는 하지 않음 |
|      wont-limit       |  y   | 캐시 | 캐시는 사용량 보고를 하지만 사용 제한은 없음          |
|         count         |  c   | 캐시 | "사용횟수/재사용횟수" 보고 지시자                     |
|       max-uses        |  u   | 서버 | 서버가 캐시를 사용해서 응답할 수 있는 최대 횟수       |
|      max-reuses       |  r   | 서버 | 서버가 캐시를 재사용해서 응답할 수 있는 최대 횟수     |
|       do-report       |  d   | 서버 | 서버가 프록시에게 사용량 보고 요구                    |
|      dont-report      |  e   | 서버 | 서버가 사용량 보고를 원치 않음                        |
|        timeout        |  t   | 서버 | 리소스 계량에 시간 제한을 둠                          |
|       wont-ask        |  n   | 서버 | 서버가 계량 정보를 원치 않음                          |

※ 적중 계량에서 '재사용 횟수'는 클라이언트 요청을 재검증한 횟수, '사용 횟수'는 요청에 응답한 횟수

- Meter 헤더는 프록시의 요청과 서버의 응답에 담김
- 프록시는 적중 계량을 할 수 있다고 서버에게 알리고, 서버는 프록시에게 적중 횟수를 요구

<br>

## 4. 개인 정보 보호에 대해

- 많은 사용자들이 자신의 HTTP 트랜잭션이 로깅되고 있다는 것을 모를 수 있음
- 그러므로 로깅하는 웹 서버와 프록시는 최종 사용자의 개인 정보 보호에 힘써야 함
- 로깅은 사용자들의 인지나 허가가 없으면 사생활 침해가 된다는 것을 유념할 것
